---
title: >
  <a href="https://github.com/b-cubed-eu/b3gbi" target="_blank">
    <img src="b3gbi.png" style="width:60px; vertical-align:middle; margin-right:5px;">
  </a>General indicators
format:
  html:
    code_fold: hide
---

```{r, echo = FALSE}
#load library
library(b3gbi)

```

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Observed species richness

This fundamental indicator quantifies the total number of unique species detected within a given spatial unit (e.g., grid cell, for indicator_map) or temporal period (e.g., year, for indicator_ts). It provides a straightforward measure of detected biodiversity.

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
OSR_map <- obs_richness_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium",
                            shapefile_path = './data/spatial/Flanders.shp')

OSR_ts <- obs_richness_ts(Angiosperm_data_cube, 
                          level = "country", 
                          region = "Belgium",
                          shapefile_path = './data/spatial/Flanders.shp')

plot(OSR_map)

plot(OSR_ts)
```

```{r, echo = FALSE}
OSR_map <- readRDS('OSR_map.rds')
plot(OSR_map)
```

```{r, echo = FALSE}
OSR_ts <- readRDS('OSR_ts.rds')
plot(OSR_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Total Occurrences

This variable quantifies the overall number of species occurrence records within a spatial unit or temporal period. While not a biodiversity indicator itself, it is crucial for understanding data comprehensiveness and distribution. It is presented as a map showing data density or a time series of annual record counts.

```{r, eval=FALSE}
#load library
library(b3gbi)

TO_map <- total_occ_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                          shapefile_path = './data/spatial/Flanders.shp')

TO_ts <- total_occ_ts(Angiosperm_data_cube, 
                          level = "country", 
                          region = "Belgium",
                          shapefile_path = './data/spatial/Flanders.shp')

plot(TO_map)

plot(TO_ts)
```

```{r, echo = FALSE}
TO_map <- readRDS('TO_map.rds')
plot(TO_map)
```

```{r, echo = FALSE}
TO_ts <- readRDS('TO_ts.rds')
plot(TO_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Evenness

Evenness measures how uniformly individuals (or observations in GBIF data) are distributed among species within a given area or over time. It complements species richness by providing insight into community structure. b3gbi supports Pielou's Evenness and Williams' Evenness, displaying their values spatially on maps (indicator_map) or as trends over time (indicator_ts).

### Pielou's Evenness

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
PEM_map <-  pielou_evenness_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

PEM_ts <-  pielou_evenness_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(PEM_map)

plot(PEM_ts)

```

```{r, echo = FALSE}
PEM_map <- readRDS('PEM_map.rds')
plot(PEM_map)
```

```{r, echo = FALSE}
PEM_ts <- readRDS('PEM_ts.rds')
plot(PEM_ts)
```

### Williams' Evenness

```{r, eval=FALSE}
#load library
library(b3gbi)

WEM_map <- williams_evenness_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

WEM_ts <- williams_evenness_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(WEM_map)

plot(WEM_ts)

```


```{r, echo = FALSE}
WEM_map <- readRDS('WEM_map.rds')
plot(WEM_map)
```

```{r, echo = FALSE}
WEM_ts <- readRDS('WEM_ts.rds')
plot(WEM_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Rarity

Rarity quantifies the scarcity or infrequency of species, and when summed over multiple species, serves as a crucial biodiversity indicator for conservation. b3gbi offers two distinct measures: Abundance-Based Rarity (based on species' proportional occurrences) and Area-Based Rarity (based on species' spatial occupancy). These can be mapped (indicator_map) to identify areas with a higher presence of rare species, or tracked over time (indicator_ts) to observe changes in overall rarity.

### Abundance - Based Rarity
```{r, eval=FALSE}
#load library
library(b3gbi)

AbRM_map <- ab_rarity_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

AbRM_ts <- ab_rarity_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(AbRM_map)

plot(AbRM_ts)

```

```{r, echo = FALSE}
AbRM_map <- readRDS('AbRM_map.rds')
plot(AbRM_map)
```

```{r, echo = FALSE}
AbRM_ts <- readRDS('AbRM_ts.rds')
plot(AbRM_ts)
```

### Area-based rarity
```{r, eval=FALSE}
#load library
library(b3gbi)

ArRM_map <-  area_rarity_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

ArRM_ts <-  area_rarity_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(ArRM_map)

plot(ArRM_ts)

```

```{r, echo = FALSE}
ArRM_map <- readRDS('ArRM_map.rds')
plot(ArRM_map)
```

```{r, echo = FALSE}
ArRM_ts <- readRDS('ArRM_ts.rds')
plot(ArRM_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Estimated Hill Diversity

Hill Diversity provides a unified framework for various diversity measures, allowing for different emphases on rare versus common species through a single parameter, q. b3gbi calculates three common forms: q=0 (approximates Species Richness, weighing all species equally), q=1 (emphasizes common species, like Hill-Shannon), and q=2 (emphasizes very common species, like Hill-Simpson). These indicators represent the "effective number of species" and can be mapped (indicator_map) or tracked over time (indicator_ts) to provide multi-faceted insights into biodiversity patterns.

### Species richness (q=0)
```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
SR_map <-  hill0_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

SR_ts <-  hill0_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(SR_map)

plot(SR_ts)

```

```{r, echo = FALSE}
SR_map <- readRDS('SR_map.rds')
plot(SR_map)
```

```{r, echo = FALSE}
SR_ts <- readRDS('SR_ts.rds')
plot(SR_ts)
```

### Hill - Shanon (q=1)
```{r, eval=FALSE}
#load library
library(b3gbi)

HSh_map <- hill1_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')



HSh_ts <- hill1_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(HSh_map)

plot(HSh_ts)

```
`

```{r, echo = FALSE}
HSh_map <- readRDS('HSh_map.rds')
plot(HSh_map)
```

```{r, echo = FALSE}
HSh_ts <- readRDS('HSh_ts.rds')
plot(HSh_ts)
```

### Hill - Simpson (q=2)

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
HSi_map <- hill2_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')


HSi_ts <- hill2_ts(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium" , 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(HSi_map)

plot(HSi_ts)
```

```{r, echo = FALSE}
HSi_map <- readRDS('HSi_map.rds')
plot(HSi_map)
```

```{r, echo = FALSE}
HSi_ts <- readRDS('HSi_ts.rds')
plot(HSi_ts)
```

:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Cumulative Species Richness

This indicator tracks the total number of unique species observed from the beginning of a specified time period up to a given year. It provides an estimation of how many new species are still being recorded over time within a region, helping to evaluate sampling effort and assess the overall recorded biodiversity over the study duration. This is an inherently temporal indicator, presented as a time series (indicator_ts).

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
CR_ts <- cum_richness_ts(Angiosperm_data_cube, 
                         level = "country", 
                         region = "Belgium",
                          shapefile_path = './data/spatial/Flanders.shp')

plot(CR_ts)
```

```{r, echo = FALSE}
CR_ts <- readRDS('CR_ts.rds')
plot(OSR_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Mean Year of Occurrence (Newness)

This variable calculates the average year of occurrence for all records within a given spatial unit (e.g., grid cell, for indicator_map) or temporal unit (e.g., year, for indicator_ts), providing an estimation of the relative recency of observations. Maps can highlight areas with more recent average records, while time series show the average observation date over cumulative data.

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
NN_map <- newness_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

#TODO;check dat NA buiten Vlaanderen resultaat niet beÃ¯nvloedt?
NN_ts <- newness_ts(Angiosperm_data_cube, 
                          level = "country", 
                          region = "Belgium",
                          shapefile_path = './data/spatial/Flanders.shp')

plot(NN_map)

plot(NN_ts)
```

```{r, echo = FALSE}
NN_map <- readRDS('NN_map.rds')
plot(NN_map)
```

```{r, echo = FALSE}
NN_ts <- readRDS('NN_ts.rds')
plot(NN_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Occurrence Density

Occurrence Density measures the spatial concentration of records by calculating the total number of occurrences per square kilometre. This allows for more meaningful comparisons between spatial units of different sizes. It can be displayed as a map (indicator_map) illustrating areas with higher concentrations of records, or as a time series (indicator_ts) showing changes in the rate of recording over time for the study area.

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
OD_map <- occ_density_map(Angiosperm_data_cube,
                            level = "country", 
                            region = "Belgium", 
                            shapefile_path = './data/spatial/Flanders.shp')

plot(OD_map)

```

```{r, echo = FALSE}
OD_map <- readRDS('OD_map.rds')
plot(OD_map)
```

```{r, echo = FALSE, eval=FALSE}
OD_ts <- readRDS('OD_ts.rds')
plot(OD_ts)
```
:::

::: {.callout-tip collapse="true" appearance="minimal" icon="false"}
## Occupancy turnover

Occupancy Turnover measures the rate at which occupancy composition changes over time within a community, quantifying the balance between species "gains" and "losses" between consecutive time intervals. High turnover indicates a dynamic community with frequent species replacement, while low turnover suggests stability. This is an exclusively temporal indicator, presented as a time series (indicator_ts).

```{r, eval=FALSE}
#load library
library(b3gbi)

#Execute preprocessing step
OT_ts <- occ_turnover_ts(Angiosperm_data_cube,
                         level = "country", 
                         region = "Belgium", 
                         shapefile_path = './data/spatial/Flanders.shp')

plot(OT_ts)

```

```{r, echo = FALSE, eval= FALSE}
OT_ts <- readRDS('OT_ts.rds')
plot(OT_ts)
```
:::
